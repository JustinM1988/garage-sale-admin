<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Garage Sales Control Center</title>

    <!-- Make all relative URLs resolve from your repo site -->
    <base href="/garage-sale-admin/">

    <!-- Esri theme (for Search widget styling) + your styles -->
    <link rel="stylesheet" href="https://js.arcgis.com/4.29/esri/themes/dark/main.css?v=4.29">
    <link rel="stylesheet" href="styles.css?v=admin-1">

    <!-- Minimal fallback so the map shows even if styles.css is cached/missing -->
    <style>
      html, body { height: 100%; margin: 0; }
      .layout { min-height: calc(100vh - 56px); height: auto; }
      .map-panel { display: flex; min-height: 520px; }
      #map, .map { flex: 1; height: 60vh; min-height: 520px; }
      .btn { padding: 8px 12px; }
    </style>
  </head>
  <body>

    <!-- Top bar -->
    <header class="appbar glass">
      <div class="brand">
        <div class="logo">GS</div>
        <h1>Garage Sales Control Center</h1>
      </div>
      <div class="actions">
        <button id="btnSales" class="btn btn-secondary">Sales</button>
        <button id="btnGuide" class="btn btn-secondary">Guide</button>
        <button id="btnAdmin" class="btn btn-secondary" title="Open Admin Debug">Admin</button>
        <button id="btnSignIn" class="btn">Sign in</button>
        <button id="btnSignOut" class="btn btn-secondary" style="display:none;">Sign out</button>
      </div>
    </header>

    <!-- Layout: left form, right map -->
    <main class="layout">

      <!-- Left panel: editor -->
      <section class="panel form-panel glass">
        <div class="section-title">Sale Editor</div>

        <div class="field-row">
          <label for="address">Address</label>
          <input id="address" type="text" placeholder="e.g., 1024 Ocean Breeze St" />
        </div>

        <div class="grid-2">
          <div class="field-row">
            <label for="dateStart">Start Date</label>
            <input id="dateStart" type="date" />
          </div>
          <div class="field-row">
            <label for="dateEnd">End Date</label>
            <input id="dateEnd" type="date" />
          </div>
        </div>

        <div class="section-subtitle">Time range</div>
        <div class="grid-2">
          <div class="field-row">
            <label for="timeStartHour">Start</label>
            <div class="time-row">
              <input id="timeStartHour" type="number" min="1" max="12" placeholder="9" />
              <span>:</span>
              <input id="timeStartMin" type="number" min="0" max="59" placeholder="00" />
              <select id="timeStartAmPm" aria-label="Start AM/PM">
                <option>AM</option>
                <option>PM</option>
              </select>
            </div>
          </div>
          <div class="field-row">
            <label for="timeEndHour">End</label>
            <div class="time-row">
              <input id="timeEndHour" type="number" min="1" max="12" placeholder="2" />
              <span>:</span>
              <input id="timeEndMin" type="number" min="0" max="59" placeholder="00" />
              <select id="timeEndAmPm" aria-label="End AM/PM">
                <option>AM</option>
                <option selected>PM</option>
              </select>
            </div>
          </div>
        </div>

        <div class="field-row">
          <label class="checkbox">
            <input id="chkCompose" type="checkbox" checked />
            Compose Description from time + details
          </label>
        </div>

        <div class="field-row">
          <label for="details">Sale details</label>
          <textarea id="details" placeholder="What’s for sale? e.g., A Sofa, Dining Room Set, tools ..."></textarea>
        </div>

        <div class="field-row">
          <label for="descriptionRaw">Description (saved to layer)</label>
          <textarea id="descriptionRaw" placeholder="Will auto-fill from time + details"></textarea>
        </div>

        <div class="form-actions">
          <button id="btnNew" class="btn btn-secondary">New</button>
          <button id="btnCancel" class="btn btn-secondary" style="display:none;">Cancel</button>
          <div class="spacer"></div>
          <button id="btnDelete" class="btn btn-danger">Delete</button>
          <button id="btnSave" class="btn">Save</button>
        </div>

        <div id="status" class="status">
          Click a sale to edit, or click <strong>New</strong> to place a new one.
        </div>
      </section>

      <!-- Right panel: map -->
      <section class="panel map-panel glass">
        <div id="map" class="map"></div>
        <div id="modeChip" class="mode-chip" style="display:none;">
          Add mode — move the cursor and click to place
        </div>
        <div id="mapFooter" class="map-footer">
          <span id="coords">Lon: — • Lat: —</span>
          <span class="hint">Tip: Search an address, then click to fine-tune.</span>
        </div>
      </section>

    </main>

    <!-- Load app AFTER the DOM exists (one script only) -->
    <script type="module" src="app.js?v=admin-1"></script>

    <noscript>
      <p style="padding:12px">This app requires JavaScript.</p>
    </noscript>
  </body>
</html>
